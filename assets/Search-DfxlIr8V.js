import{_ as E,r as i,o as F,k as P,l as I,c as o,a,m as q,b as c,w as g,n as U,e as r,F as v,i as d,t as p,f as y,g as z,d as j,h as l,u as G,s as J}from"./index-CXkfDJvP.js";import{u as O}from"./article-DUuUa79x.js";const Q={class:"search-page"},W={class:"search-form"},X={key:0,class:"search-info"},Y={class:"search-results"},Z=["onClick"],ee=["innerHTML"],te=["innerHTML"],ae={class:"result-meta"},se={class:"meta-left"},le={class:"author-name"},ne={class:"publish-date"},oe={class:"meta-right"},re={class:"tag-list"},ue={key:0,class:"pagination-container"},ie={__name:"Search",setup(ce){const f=P(),b=j(),k=O(),t=i(""),m=i(!1),h=i([]),u=i(0),_=i(1),w=i(10);F(()=>{f.query.q&&(t.value=f.query.q,C())}),I(()=>f.query.q,s=>{s!==t.value&&(t.value=s||"",_.value=1,C())});const C=async()=>{if(!t.value.trim()){h.value=[],u.value=0;return}m.value=!0;try{await k.fetchArticles({search:t.value,page:_.value,limit:w.value}),h.value=k.articles,u.value=k.totalArticles}catch(s){console.error("搜索失败:",s)}finally{m.value=!1}},x=()=>{t.value.trim()&&(_.value=1,b.push({path:"/search",query:{q:t.value.trim()}}))},A=s=>{_.value=s,C()},M=s=>{b.push(`/article/${s}`)},L=s=>{if(!t.value.trim()||!s)return s;const e=new RegExp(t.value,"gi");return s.replace(e,S=>`<span class="highlight">${S}</span>`)};return(s,e)=>{const S=r("el-icon"),R=r("el-button"),B=r("el-input"),D=r("el-skeleton"),H=r("el-avatar"),K=r("el-tag"),N=r("el-pagination"),T=r("el-empty");return l(),o("div",Q,[e[6]||(e[6]=a("div",{class:"page-header"},[a("h1",{class:"page-title"},"搜索结果")],-1)),a("div",W,[c(B,{modelValue:t.value,"onUpdate:modelValue":e[0]||(e[0]=n=>t.value=n),placeholder:"搜索文章...",clearable:"",onKeyup:U(x,["enter"])},{append:g(()=>[c(R,{onClick:x},{default:g(()=>[c(S,null,{default:g(()=>[c(G(J))]),_:1})]),_:1})]),_:1},8,["modelValue"])]),t.value?(l(),o("div",X,[u.value>0?(l(),o(v,{key:0},[e[1]||(e[1]=d(" 找到 ")),a("strong",null,p(u.value),1),e[2]||(e[2]=d(' 条与 "')),a("strong",null,p(t.value),1),e[3]||(e[3]=d('" 相关的结果 '))],64)):m.value?q("",!0):(l(),o(v,{key:1},[e[4]||(e[4]=d(' 没有找到与 "')),a("strong",null,p(t.value),1),e[5]||(e[5]=d('" 相关的结果 '))],64))])):q("",!0),a("div",Y,[m.value?(l(),y(D,{key:0,rows:5,animated:""})):h.value.length>0?(l(),o(v,{key:1},[(l(!0),o(v,null,z(h.value,n=>(l(),o("div",{key:n.id,class:"result-item",onClick:V=>M(n.id)},[a("h3",{class:"result-title",innerHTML:L(n.title)},null,8,ee),a("p",{class:"result-summary",innerHTML:L(n.summary)},null,8,te),a("div",ae,[a("div",se,[c(H,{size:24,src:n.author.avatar},null,8,["src"]),a("span",le,p(n.author.username),1),a("span",ne,p(new Date(n.createdAt).toLocaleDateString()),1)]),a("div",oe,[a("span",re,[(l(!0),o(v,null,z(n.tags,(V,$)=>(l(),y(K,{key:$,size:"small",class:"tag-item"},{default:g(()=>[d(p(V),1)]),_:2},1024))),128))])])])],8,Z))),128)),u.value>w.value?(l(),o("div",ue,[c(N,{background:"",layout:"prev, pager, next",total:u.value,"page-size":w.value,"current-page":_.value,onCurrentChange:A},null,8,["total","page-size","current-page"])])):q("",!0)],64)):t.value?(l(),y(T,{key:2,description:"没有找到相关文章"})):(l(),y(T,{key:3,description:"请输入关键词搜索"}))])])}}},_e=E(ie,[["__scopeId","data-v-bdaf57d0"]]);export{_e as default};
